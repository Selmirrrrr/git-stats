# GitStats

GitStats is a comprehensive solution for analyzing Git repository statistics and Bitbucket pull request information. It consists of two parts: a .NET console application that extracts data from multiple repositories and Bitbucket, and a web-based dashboard for visualizing the statistics.

## Online Demo

You can try the web dashboard [here](https://selmirrrrr.github.io/git-stats/) with sample data or by uploading your own JSON file generated by the console app.

## Components

### 1. GitStats Console Application

A .NET console application that:
- Extracts commit statistics from multiple Git repositories
- Retrieves pull request information from Atlassian Bitbucket Server
- Exports the data to JSON and CSV files

### 2. GitStats Dashboard

A web-based dashboard built with React and Chart.js that visualizes the statistics from the JSON output files.

## Features

- **Data Collection**:
  - Processes multiple Git repositories in parallel for improved performance
  - Extracts commit information for a specified date range
  - Retrieves Bitbucket pull request information including reviewers and comments
  - Includes commit ID, timestamp, author/committer details, commit message, and line change statistics
  - Exports consolidated data to both JSON and CSV formats
  - Command-line interface with configurable options

- **Data Visualization**:
  - Interactive dashboard with various charts and statistics
  - Commit and PR search functionality
  - Top committer analysis (by additions, deletions, total commits)
  - Time-based analysis (commits by weekday, month, day of month)
  - Burnout risk analysis based on work patterns
  - Weekend warrior identification
  - Sentiment analysis of commit messages
  - PR workflow analytics and team collaboration metrics

## Requirements

- .NET 9.0 SDK or later
- Git installed on the system (for local repository analysis)
- Node.js and npm (for the web dashboard)
- Access to Bitbucket Server instance (for PR analysis)

## Installation

1. Clone or download this repository
2. Build the console application:
   ```
   dotnet build GitStats
   ```
3. Install the web dashboard dependencies:
   ```
   cd GitStats/WebUI
   npm install
   ```

## Usage

### Running the Console Application - Git Commit Mode

Run the application to analyze local Git repositories:

```
cd GitStats
dotnet run --folder <repository-base-path> [--start-date <yyyy-MM-dd>] [--end-date <yyyy-MM-dd>] [--output-json <output.json>] [--output-csv <output.csv>]
```

#### Git Mode Parameters:

- `--folder`: Base folder containing Git repositories (required)
- `--start-date`: Start date for commit history (default: 30 days ago)
- `--end-date`: End date for commit history (default: today)
- `--output-json`: Output JSON file path (default: git-stats.json)
- `--output-csv`: Output CSV file path (default: git-stats.csv)

#### Git Mode Example:

```
dotnet run --folder /path/to/repositories --start-date 2024-01-01 --end-date 2024-03-01 --output-json stats.json --output-csv stats.csv
```

### Running the Console Application - Bitbucket PR Mode

Run the application to retrieve pull request information from Bitbucket:

#### Using API Key Authentication (Recommended):

```
dotnet run --mode bitbucket-pr --bitbucket-url <url> --bitbucket-api-key <api-key> --bitbucket-project <project-key> [--start-date <yyyy-MM-dd>] [--end-date <yyyy-MM-dd>] [--output-pr-json <file.json>]
```

#### Using Username/Password Authentication (Legacy):

```
dotnet run --mode bitbucket-pr --bitbucket-url <url> --bitbucket-username <username> --bitbucket-password <password> --bitbucket-project <project-key> [--start-date <yyyy-MM-dd>] [--end-date <yyyy-MM-dd>] [--output-pr-json <file.json>]
```

#### Bitbucket PR Mode Parameters:

- `--mode`: Set to 'bitbucket-pr' to enable Bitbucket PR analysis mode
- `--bitbucket-url`: Bitbucket server URL (required)
- `--bitbucket-api-key`: Bitbucket API key for Bearer token authentication (recommended)
- `--bitbucket-username`: Bitbucket username (legacy basic auth)
- `--bitbucket-password`: Bitbucket password (legacy basic auth)
- `--bitbucket-project`: Bitbucket project key (required)
- `--start-date`: Start date for PR history (default: 30 days ago)
- `--end-date`: End date for PR history (default: today)
- `--output-pr-json`: Output JSON file path for PR data (default: bitbucket-prs.json)

#### Bitbucket PR Mode Example (API Key):

```
dotnet run --mode bitbucket-pr --bitbucket-url https://bitbucket.example.com --bitbucket-api-key YOUR_API_KEY --bitbucket-project PROJECT_KEY --start-date 2024-01-01 --end-date 2024-03-01 --output-pr-json prs.json
```

#### Complete Workflow Example

This example demonstrates a complete workflow for analyzing both Git commits and Bitbucket PRs:

```bash
# Step 1: Extract commit data from local repositories
dotnet run --folder /path/to/repositories --start-date 2024-01-01 --end-date 2024-03-31 --output-json commits.json

# Step 2: Extract PR data from Bitbucket for the same time period
dotnet run --mode bitbucket-pr --bitbucket-url https://bitbucket.example.com --bitbucket-api-key YOUR_API_KEY --bitbucket-project PROJECT_KEY --start-date 2024-01-01 --end-date 2024-03-31 --output-pr-json prs.json

# Step 3: Start the web dashboard for visualization
cd WebUI
npm run dev

# Step 4: Open http://localhost:3000 in your browser and upload both JSON files
```

### Running the Web Dashboard Locally

```
cd GitStats/WebUI
npm run dev
```

This will start the development server, and you can access the dashboard at http://localhost:3000. Upload the JSON file generated by the console application to visualize the statistics.

## Output Formats

### Git Commit Mode JSON Format

```json
[
  {
    "CommitId": "abcd1234...",
    "CommitTime": "2024-02-15 10:30:45",
    "CommitterEmail": "user@example.com",
    "CommitterName": "John Doe",
    "CommitMessage": "Fix login bug",
    "Additions": 15,
    "Deletions": 7,
    "RepositoryName": "repo1"
  },
  ...
]
```

### Bitbucket PR Mode JSON Format

```json
[
  {
    "Author": "John Doe",
    "RepositoryName": "my-repo",
    "ProjectName": "PROJECT",
    "IncomingBranchName": "feature/new-feature",
    "DestinationBranchName": "main",
    "Validators": [
      "Jane Smith",
      "Bob Johnson"
    ],
    "Rejecters": [],
    "Date": "2024-02-15 14:30:22",
    "Messages": [
      {
        "Author": "Jane Smith",
        "Message": "Looks good, approved!",
        "Date": "2024-02-16 09:15:45"
      }
    ]
  },
  ...
]
```

## Dashboard Features

The web dashboard provides various visualizations and insights:

1. **Repository Overview**:
   - Total number of commits
   - Total additions and deletions
   - Total number of contributors

2. **Search Functionality**:
   - Search for commits by ID, message, author, or repository

3. **Top Committer Analysis**:
   - Top committers by number of commits
   - Top committers by total changes (additions + deletions)
   - Top committers by additions
   - Top committers by deletions
   - Top "night owls" (commits between midnight and 6 AM)

4. **Time-based Analysis**:
   - Commits by day of week
   - Commits by month
   - Commits by day of month

5. **Work Pattern Analysis**:
   - Burnout risk assessment
   - Weekend warrior detection
   - Commit hour heatmap
   - Sentiment analysis of commit messages

6. **Pull Request Analytics**:
   - PR activity trends over time
   - Top PR authors and most active contributors
   - Top reviewers and review activity distribution
   - Team collaboration and velocity scores
   - Branch usage patterns and distribution
   - Repository PR statistics comparison

## How to Use with GitHub Pages

The GitStats web dashboard is also available on GitHub Pages. You can:

1. Visit the [live demo](https://selmirrrrr.github.io/git-stats/)
2. Upload your own JSON file generated by the console application
3. Explore the visualizations directly in your browser

## Building Your Own Version

To deploy your own version to GitHub Pages:

1. Fork this repository
2. Update the `base` property in `GitStats/WebUI/vite.config.ts` to match your repository name
3. Enable GitHub Pages in your repository settings
4. The GitHub Actions workflow will automatically deploy the dashboard when you push to the main branch

## Limitations

- The Bitbucket PR functionality is currently tested with Atlassian Bitbucket Server v8.19.13
- For Bitbucket access, the user must have appropriate permissions to view repositories and pull requests
- Large repositories may require more memory and processing time

## Performance Considerations

- The console application processes repositories in parallel using tasks to improve performance
- Large repositories with extensive commit histories might take longer to process
- The application reports processing time upon completion
- The web dashboard is optimized for handling large datasets with efficient rendering

## License

MIT
